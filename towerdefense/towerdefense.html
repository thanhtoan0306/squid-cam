<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tower Defense Game</title>
    <!-- <script type="module" src="/components/logic.js"></script> -->

    <style>
      body {
        margin: 0;
        padding: 20px;
        background: #222;
        color: white;
        font-family: 'Arial', sans-serif;
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      #game-container {
        border: 3px solid #444;
        border-radius: 10px;
        box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
      }

      h1 {
        display: none;
      }
    </style>
  </head>

  <body>
    <div id="game-container"></div>
    <script type="module" src="phaser.min.js"></script>
    <script type="module" src="gameMain.js"></script>

    <!-- <script type="module">
      try {
        const { ipcRenderer } = require('electron');

        // TikTok chat integration
        ipcRenderer.on('tiktok-chat', (event, data) => {
          console.log('screen2', data);
          if (!gameState.gameOver) {
            const scene = game.scene.scenes[0];
            const photoUrl = typeof data.photo === 'string' ? data.photo : '';
            spawnEnemy.call(scene, data.user, photoUrl);
          }
        });

        ipcRenderer.on('clear-all-towers', () => {
          const scene = game.scene.scenes[0];
          scene.towers.clear(true, true); // Remove all tower sprites
          // If you keep a gameState.towers array, clear it too:
          if (gameState.towers) gameState.towers = [];
        });

        // Grid toggle integration
        ipcRenderer.on('toggle-grid', () => {
          console.log('Toggle grid received');

          const scene = game.scene.scenes[0];
          if (!gridGraphics) {
            gridGraphics = scene.add.graphics();
          }
          gridGraphics.clear();
          gridVisible = !gridVisible;
          if (gridVisible) {
            gridGraphics.lineStyle(1, 0x00ffff, 0.3);
            const cellW = config.width / 10;
            const cellH = config.height / 10;
            for (let i = 1; i < 10; i++) {
              // Vertical lines
              gridGraphics.lineBetween(i * cellW, 0, i * cellW, config.height);
              // Horizontal lines
              gridGraphics.lineBetween(0, i * cellH, config.width, i * cellH);
            }
          }
        });
      } catch (e) {
        // Not running in Electron, ignore
      }
    </script> -->
  </body>
</html>
